<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Samenvoegen, één groep maken</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:#101a33;
      --card:#16244a;
      --card2:#0f1b3d;
      --text:#f3f6ff;
      --muted:#b9c2e3;
      --good:#38d58a;
      --warn:#ffcc66;
      --bad:#ff6b6b;
      --line:rgba(255,255,255,0.14);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius: 18px;
    }

    *{ box-sizing: border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans", Arial;
      background: radial-gradient(1200px 700px at 30% 10%, #1b2a5b 0%, var(--bg) 60%);
      color: var(--text);
      user-select:none;
      touch-action: manipulation;
    }

    .wrap{
      display:grid;
      grid-template-columns: 420px 1fr;
      gap:16px;
      padding:16px;
      height: 100vh;
    }

    @media (max-width: 1100px){
      .wrap{ grid-template-columns: 1fr; height:auto; }
    }

    .panel{
      background: linear-gradient(180deg, var(--panel), #0a132a);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:16px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .title{
      font-size: 22px;
      font-weight: 800;
      letter-spacing: 0.2px;
      margin:0;
    }
    .subtitle{
      margin:0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.4;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .btn{
      appearance:none;
      border:none;
      background: var(--card);
      color: var(--text);
      border:1px solid var(--line);
      padding:12px 14px;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 700;
      cursor:pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      min-width: 120px;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{ background: linear-gradient(180deg, #1f3bff, #1630c9); border-color: rgba(255,255,255,0.20); }
    .btn.good{ background: linear-gradient(180deg, #19c774, #119d5a); border-color: rgba(255,255,255,0.20); }
    .btn.warn{ background: linear-gradient(180deg, #ffb84d, #e08b14); color:#1a1200; border-color: rgba(0,0,0,0.15); }
    .btn.ghost{ background: transparent; }

    .chip{
      background: rgba(255,255,255,0.08);
      border:1px solid var(--line);
      border-radius: 999px;
      padding:8px 10px;
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:700;
      color: var(--text);
    }
    .chip label{ color: var(--muted); font-weight:700; font-size: 13px; }
    .chip input{
      width:64px;
      font-size: 16px;
      font-weight: 800;
      border:none;
      outline:none;
      background: transparent;
      color: var(--text);
      text-align:center;
    }

    .hint{
      background: rgba(255,255,255,0.06);
      border:1px solid var(--line);
      border-radius: 14px;
      padding:12px;
      color: var(--muted);
      line-height: 1.4;
      font-size: 14px;
    }

    .stage{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:16px;
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      gap:14px;
      min-height: 560px;
    }

    .banner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      padding:14px 16px;
      border-radius: 16px;
      background: rgba(255,255,255,0.06);
      border:1px solid var(--line);
    }

    .prompt{
      font-size: 26px;
      font-weight: 900;
      letter-spacing: 0.2px;
      margin:0;
    }
    .status{
      font-size: 18px;
      font-weight: 900;
      padding:10px 14px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,0.06);
      min-width: 220px;
      text-align:center;
    }
    .status.good{ background: rgba(56,213,138,0.18); border-color: rgba(56,213,138,0.45); }
    .status.warn{ background: rgba(255,204,102,0.18); border-color: rgba(255,204,102,0.45); }
    .status.bad{ background: rgba(255,107,107,0.18); border-color: rgba(255,107,107,0.45); }

    .zones{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:14px;
      flex:1;
      min-height: 420px;
    }

    @media (max-width: 1100px){
      .zones{ grid-template-columns: 1fr; }
    }

    .zone{
      border-radius: 18px;
      border:1px dashed rgba(255,255,255,0.22);
      background: rgba(0,0,0,0.10);
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      padding:12px;
      gap:10px;
      min-height: 240px;
    }
    .zone h3{
      margin:0;
      font-size: 16px;
      color: var(--muted);
      font-weight: 800;
      letter-spacing: 0.2px;
    }

    .tray{
      flex:1;
      border-radius: 14px;
      background: rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.10);
      position:relative;
      overflow:hidden;
    }

    .divider{
      position:absolute;
      left: 50%;
      top: 0;
      bottom:0;
      width:2px;
      background: rgba(255,255,255,0.10);
      transform: translateX(-1px);
      pointer-events:none;
    }

    .token{
      width: 60px;
      height: 60px;
      border-radius: 999px;
      position:absolute;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 30px;
      font-weight: 900;
      color: rgba(0,0,0,0.55);
      box-shadow: 0 10px 22px rgba(0,0,0,0.35);
      border: 2px solid rgba(255,255,255,0.22);
      touch-action: none;
      cursor: grab;
    }
    .token:active{ cursor: grabbing; }

    .token.a{ background: radial-gradient(circle at 30% 25%, #ffd1f0, #ff59c7); }
    .token.b{ background: radial-gradient(circle at 30% 25%, #cfe9ff, #3aa3ff); }

    .pulse{
      animation: pulse 1.1s ease-in-out infinite;
    }
    @keyframes pulse{
      0%{ transform: scale(1); }
      50%{ transform: scale(1.04); }
      100%{ transform: scale(1); }
    }

    .footer{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      padding:12px 14px;
      border-radius: 16px;
      background: rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.10);
      color: var(--muted);
      font-weight: 700;
    }

    .kbd{
      background: rgba(255,255,255,0.08);
      border:1px solid var(--line);
      padding:6px 10px;
      border-radius: 10px;
      color: var(--text);
      font-weight: 900;
    }

    .small{
      font-size: 13px;
      line-height: 1.35;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <aside class="panel">
      <h1 class="title">Samenvoegen</h1>
      <p class="subtitle">Doel: kinderen laten zien dat twee groepjes samen één groep worden. Niet uitrekenen, maar begrijpen wat samen is.</p>

      <div class="row">
        <button class="btn primary" id="btnNew">Nieuw voorbeeld</button>
        <button class="btn ghost" id="btnReset">Terugzetten</button>
      </div>

      <div class="row">
        <div class="chip">
          <label>Groep links</label>
          <input id="leftCount" type="number" min="1" max="10" value="3" />
        </div>
        <div class="chip">
          <label>Groep rechts</label>
          <input id="rightCount" type="number" min="1" max="10" value="2" />
        </div>
      </div>

      <div class="row">
        <button class="btn warn" id="btnShow">Laat samen zien</button>
        <button class="btn good" id="btnCelebrate">Goed zo</button>
      </div>

      <div class="hint">
        <div style="font-weight:900; color: var(--text); margin-bottom:6px;">Leerkrachtzinnen</div>
        <div class="small">
          <div>Wat gebeurt er met de groepjes als je ze bij elkaar legt</div>
          <div>Eerst apart, nu samen</div>
          <div>Wat bleef hetzelfde, wat veranderde</div>
        </div>
      </div>

      <div class="hint">
        <div style="font-weight:900; color: var(--text); margin-bottom:6px;">Bediening</div>
        <div class="small">
          <div>Sleep de rondjes van links en rechts naar het middenvak</div>
          <div>Gebruik Laat samen zien als je wilt benadrukken dat het één groep is</div>
          <div>Toetsen: N nieuw voorbeeld, R reset</div>
        </div>
      </div>
    </aside>

    <main class="stage">
      <div class="banner">
        <p class="prompt" id="prompt">Leg de twee groepjes samen</p>
        <div class="status warn" id="status">Eerst apart, daarna samen</div>
      </div>

      <div class="zones">
        <section class="zone" aria-label="Links">
          <h3>Groepje links</h3>
          <div class="tray" id="trayLeft"></div>
        </section>

        <section class="zone" aria-label="Samen">
          <h3>Samen, één groep</h3>
          <div class="tray" id="trayCenter">
            <div class="divider"></div>
          </div>
        </section>

        <section class="zone" aria-label="Rechts">
          <h3>Groepje rechts</h3>
          <div class="tray" id="trayRight"></div>
        </section>
      </div>

      <div class="footer">
        <div>
          <span class="kbd">Tip</span>
          <span class="small">Laat kinderen wijzen en verwoorden. Vraag niet hoeveel het samen is.</span>
        </div>
        <div class="small">Tokens in het middenvak: <span id="centerCount">0</span></div>
      </div>
    </main>
  </div>

  <script>
    const trayLeft = document.getElementById("trayLeft");
    const trayRight = document.getElementById("trayRight");
    const trayCenter = document.getElementById("trayCenter");
    const statusEl = document.getElementById("status");
    const centerCountEl = document.getElementById("centerCount");

    const leftCountInput = document.getElementById("leftCount");
    const rightCountInput = document.getElementById("rightCount");

    const btnNew = document.getElementById("btnNew");
    const btnReset = document.getElementById("btnReset");
    const btnShow = document.getElementById("btnShow");
    const btnCelebrate = document.getElementById("btnCelebrate");

    let tokens = [];
    let originalPositions = new Map();

    function randInt(min, max){
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function clamp(v, min, max){
      return Math.max(min, Math.min(max, v));
    }

    function rect(el){
      return el.getBoundingClientRect();
    }

    function placeTokenInTray(token, tray){
      const tRect = rect(tray);
      const pad = 16;
      const size = 60;
      const x = randInt(pad, Math.max(pad, Math.floor(tRect.width - size - pad)));
      const y = randInt(pad, Math.max(pad, Math.floor(tRect.height - size - pad)));
      token.style.left = x + "px";
      token.style.top = y + "px";
      tray.appendChild(token);
      token.dataset.tray = tray.id;
    }

    function createToken(kind){
      const el = document.createElement("div");
      el.className = "token " + kind;
      el.textContent = kind === "a" ? "●" : "●";
      el.setAttribute("role", "button");
      el.setAttribute("aria-label", "Token");
      enableDrag(el);
      return el;
    }

    function clearAll(){
      tokens.forEach(t => t.remove());
      tokens = [];
      originalPositions.clear();
      updateCenterCount();
    }

    function updateCenterCount(){
      const count = tokens.filter(t => t.dataset.tray === "trayCenter").length;
      centerCountEl.textContent = String(count);
      if (count > 0){
        statusEl.classList.remove("bad");
        statusEl.classList.add("warn");
      }
    }

    function buildFromInputs(){
      clearAll();
      const leftN = clamp(parseInt(leftCountInput.value || "3", 10), 1, 10);
      const rightN = clamp(parseInt(rightCountInput.value || "2", 10), 1, 10);
      leftCountInput.value = leftN;
      rightCountInput.value = rightN;

      for (let i = 0; i < leftN; i++){
        const t = createToken("a");
        tokens.push(t);
        placeTokenInTray(t, trayLeft);
      }
      for (let i = 0; i < rightN; i++){
        const t = createToken("b");
        tokens.push(t);
        placeTokenInTray(t, trayRight);
      }

      // Save original positions for reset
      tokens.forEach(t => {
        originalPositions.set(t, {
          trayId: t.dataset.tray,
          left: t.style.left,
          top: t.style.top
        });
      });

      statusEl.textContent = "Eerst apart, daarna samen";
      statusEl.className = "status warn";
      updateCenterCount();
    }

    function newExample(){
      // Keep it within small numbers by default, teacher can override
      const leftN = randInt(1, 5);
      const rightN = randInt(1, 5);
      leftCountInput.value = leftN;
      rightCountInput.value = rightN;
      buildFromInputs();
    }

    function reset(){
      tokens.forEach(t => {
        const info = originalPositions.get(t);
        if (!info) return;
        const tray = document.getElementById(info.trayId);
        tray.appendChild(t);
        t.dataset.tray = info.trayId;
        t.style.left = info.left;
        t.style.top = info.top;
      });
      statusEl.textContent = "Eerst apart, daarna samen";
      statusEl.className = "status warn";
      updateCenterCount();
    }

    function showTogether(){
      // Visual cue: nudge all tokens into center tray without changing total
      statusEl.textContent = "Nu samen, één groep";
      statusEl.className = "status good";

      // Move all tokens to center, but keep layout tidy
      const cRect = rect(trayCenter);
      const pad = 18;
      const size = 60;
      const cols = Math.max(1, Math.floor((cRect.width - pad * 2) / (size + 10)));
      tokens.forEach((t, idx) => {
        trayCenter.appendChild(t);
        t.dataset.tray = "trayCenter";
        const row = Math.floor(idx / cols);
        const col = idx % cols;
        const x = pad + col * (size + 10);
        const y = pad + row * (size + 10);
        t.style.left = x + "px";
        t.style.top = y + "px";
      });

      updateCenterCount();
    }

    function celebrate(){
      // Gentle celebration, no sound
      statusEl.textContent = "Goed gezien, twee groepjes werden één groep";
      statusEl.className = "status good";
      tokens.forEach(t => t.classList.add("pulse"));
      setTimeout(() => tokens.forEach(t => t.classList.remove("pulse")), 1200);
    }

    // Drag logic for touch and mouse
    function enableDrag(el){
      let dragging = false;
      let startX = 0, startY = 0;
      let elStartLeft = 0, elStartTop = 0;

      const onPointerDown = (e) => {
        e.preventDefault();
        el.setPointerCapture(e.pointerId);
        dragging = true;

        startX = e.clientX;
        startY = e.clientY;

        elStartLeft = parseFloat(el.style.left || "0");
        elStartTop = parseFloat(el.style.top || "0");

        statusEl.textContent = "Sleep naar het midden om samen te maken";
        statusEl.className = "status warn";
      };

      const onPointerMove = (e) => {
        if (!dragging) return;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;

        // Keep within current tray bounds while dragging, then snap on release
        el.style.left = (elStartLeft + dx) + "px";
        el.style.top = (elStartTop + dy) + "px";
      };

      const onPointerUp = (e) => {
        if (!dragging) return;
        dragging = false;

        // Decide which tray it is now in, based on pointer position
        const x = e.clientX;
        const y = e.clientY;

        const trays = [trayLeft, trayCenter, trayRight];
        const hit = trays.find(t => {
          const r = rect(t);
          return x >= r.left && x <= r.right && y >= r.top && y <= r.bottom;
        });

        const target = hit || document.getElementById(el.dataset.tray || "trayLeft");
        snapToTray(el, target, x, y);
        updateCenterCount();

        const centerNow = tokens.filter(t => t.dataset.tray === "trayCenter").length;
        if (centerNow === tokens.length){
          statusEl.textContent = "Nu samen, één groep";
          statusEl.className = "status good";
        }
      };

      el.addEventListener("pointerdown", onPointerDown);
      el.addEventListener("pointermove", onPointerMove);
      el.addEventListener("pointerup", onPointerUp);
      el.addEventListener("pointercancel", onPointerUp);
    }

    function snapToTray(el, tray, clientX, clientY){
      const fromTray = document.getElementById(el.dataset.tray || "trayLeft");
      const toTray = tray;

      const toRect = rect(toTray);
      const size = 60;
      const pad = 16;

      // Compute position relative to target tray
      let x = clientX - toRect.left - size / 2;
      let y = clientY - toRect.top - size / 2;

      x = clamp(x, pad, Math.max(pad, Math.floor(toRect.width - size - pad)));
      y = clamp(y, pad, Math.max(pad, Math.floor(toRect.height - size - pad)));

      toTray.appendChild(el);
      el.dataset.tray = toTray.id;
      el.style.left = x + "px";
      el.style.top = y + "px";

      // Update status if moved out of center
      const centerNow = tokens.filter(t => t.dataset.tray === "trayCenter").length;
      if (centerNow === 0){
        statusEl.textContent = "Eerst apart, daarna samen";
        statusEl.className = "status warn";
      }
    }

    // Wire up buttons
    btnNew.addEventListener("click", newExample);
    btnReset.addEventListener("click", reset);
    btnShow.addEventListener("click", showTogether);
    btnCelebrate.addEventListener("click", celebrate);

    leftCountInput.addEventListener("change", buildFromInputs);
    rightCountInput.addEventListener("change", buildFromInputs);

    // Keyboard shortcuts for teacher laptop
    window.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "n") newExample();
      if (e.key.toLowerCase() === "r") reset();
    });

    // Start
    buildFromInputs();
  </script>
</body>
</html>
